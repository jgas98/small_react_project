{"ast":null,"code":"import _defineProperty from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/src/context/index.js\";\nimport React, { Component } from 'react';\nimport { linkData } from './linkData';\nimport { socialData } from './socialData';\nimport { items } from './productData';\nvar ProductContext = React.createContext();\n\nvar ProductProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ProductProvider, _Component);\n\n  function ProductProvider() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ProductProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProductProvider)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      sidebarOpen: false,\n      links: linkData,\n      socialIcons: socialData,\n      cart: [],\n      cartTax: 0,\n      cartTotal: 0,\n      storeProducts: [],\n      //valores/data originais\n      filteredProducts: [],\n      featuredProducts: [],\n      singleProduct: {},\n      loading: true,\n      search: '',\n      price: 0,\n      min: 0,\n      max: 0,\n      company: 'todos',\n      shipping: false\n    };\n\n    _this.setProducts = function (products) {\n      var storeProducts = products.map(function (item) {\n        var id = item.sys.id;\n        var image = item.fields.image.fields.file.url;\n\n        var product = _objectSpread({\n          id: id\n        }, item.fields, {\n          image: image\n        });\n\n        return product;\n      }); //  featured products\n\n      var featuredProducts = storeProducts.filter(function (item) {\n        return item.featured === true;\n      }); //get max price\n\n      var maxPrice = Math.max.apply(Math, _toConsumableArray(storeProducts.map(function (item) {\n        return item.price;\n      })));\n      console.log(maxPrice);\n\n      _this.setState({\n        storeProducts: storeProducts,\n        filteredProducts: storeProducts,\n        featuredProducts: featuredProducts,\n        cart: _this.getStorageCart(),\n        //singleProduct: this.getStorageProduct(),\n        loading: false,\n        //price, max e maxPrice para filtrar\n        price: maxPrice,\n        max: maxPrice\n      }, function () {\n        _this.addTotals();\n      });\n    };\n\n    _this.getStorageCart = function () {\n      var cart;\n\n      if (localStorage.getItem('cart')) {\n        cart = JSON.parse(localStorage.getItem('cart'));\n      } else {\n        cart = [];\n      }\n\n      return cart;\n    };\n\n    _this.getStorageProduct = function () {\n      return localStorage.getItem('singleProduct') ? JSON.parse(localStorage.getItem('singleProduct')) : {};\n    };\n\n    _this.getTotals = function () {\n      var subTotal = 0;\n      var cartItems = 0;\n\n      _this.state.cart.forEach(function (item) {\n        subTotal += item.total;\n        cartItems += item.count;\n      });\n\n      subTotal = parseFloat(subTotal.toFixed(2));\n      var tax = subTotal * 0.2;\n      tax = parseFloat(tax.toFixed(2));\n      var total = subTotal + tax;\n      total = parseFloat(total.toFixed(2));\n      return {\n        cartItems: cartItems,\n        subTotal: subTotal,\n        tax: tax,\n        total: total\n      };\n    };\n\n    _this.addTotals = function () {\n      var totals = _this.getTotals();\n\n      _this.setState({\n        cartItems: totals.cartItems,\n        cartSubTotal: totals.subTotal,\n        cartTax: totals.tax,\n        cartTotal: totals.total\n      });\n    };\n\n    _this.syncStorage = function () {\n      localStorage.setItem('cart', JSON.stringify(_this.state.cart));\n    };\n\n    _this.addToCart = function (id) {\n      var tempCart = _toConsumableArray(_this.state.cart);\n\n      var tempProducts = _toConsumableArray(_this.state.storeProducts);\n\n      var tempItem = tempCart.find(function (item) {\n        return item.id === id;\n      });\n\n      if (!tempItem) {\n        tempItem = tempProducts.find(function (item) {\n          return item.id === id;\n        });\n        var total = tempItem.price;\n\n        var cartItem = _objectSpread({}, tempItem, {\n          count: 1,\n          total: total\n        });\n\n        tempCart = [].concat(_toConsumableArray(tempCart), [cartItem]);\n      } else {\n        tempItem.count++;\n        tempItem.total = tempItem.price * tempItem.count;\n        tempItem.total = parseFloat(tempItem.total.toFixed(2));\n      }\n\n      _this.setState(function () {\n        return {\n          cart: tempCart\n        };\n      }, function () {\n        _this.addTotals();\n\n        _this.syncStorage();\n\n        _this.openCart();\n      });\n    };\n\n    _this.setSingleProduct = function (id) {\n      var product = _this.state.storeProducts.find(function (item) {\n        return item.id === id;\n      });\n\n      localStorage.setItem('singleProduct', JSON.stringify(product));\n\n      _this.setState({\n        singleProduct: _objectSpread({}, product),\n        loading: false\n      });\n    };\n\n    _this.handleSidebar = function () {\n      _this.setState({\n        sidebarOpen: !_this.state.sidebarOpen\n      });\n    };\n\n    _this.handleCart = function () {\n      _this.setState({\n        cartOpen: !_this.state.cartOpen\n      });\n    };\n\n    _this.closeCart = function () {\n      _this.setState({\n        cartOpen: false\n      });\n    };\n\n    _this.openCart = function () {\n      _this.setState({\n        cartOpen: true\n      });\n    };\n\n    _this.increment = function (id) {\n      var tempCart = _toConsumableArray(_this.state.cart);\n\n      var cartItem = tempCart.find(function (item) {\n        return item.id === id;\n      });\n      cartItem.count++;\n      cartItem.total = cartItem.count * cartItem.price;\n      cartItem.total = parseFloat(cartItem.total.toFixed(2));\n\n      _this.setState(function () {\n        return {\n          cart: _toConsumableArray(tempCart)\n        };\n      }, function () {\n        _this.addTotals();\n\n        _this.syncStorage();\n      });\n    };\n\n    _this.decrement = function (id) {\n      var tempCart = _toConsumableArray(_this.state.cart);\n\n      var cartItem = tempCart.find(function (item) {\n        return item.id === id;\n      });\n      cartItem.count = cartItem.count - 1;\n\n      if (cartItem.count === 0) {\n        _this.removeItem(id);\n      } else {\n        cartItem.total = cartItem.count * cartItem.price;\n        cartItem.total = parseFloat(cartItem.total.toFixed(2));\n\n        _this.setState(function () {\n          return {\n            cart: _toConsumableArray(tempCart)\n          };\n        }, function () {\n          _this.addTotals();\n\n          _this.syncStorage();\n        });\n      }\n    };\n\n    _this.clearCart = function () {\n      _this.setState({\n        cart: []\n      }, function () {\n        _this.addTotals();\n\n        _this.syncStorage();\n      });\n    };\n\n    _this.removeItem = function (id) {\n      var tempCart = _toConsumableArray(_this.state.cart);\n\n      tempCart = tempCart.filter(function (item) {\n        return item.id !== id;\n      });\n\n      _this.setState({\n        cart: _toConsumableArray(tempCart)\n      }, function () {\n        _this.addTotals();\n\n        _this.syncStorage();\n      });\n    };\n\n    _this.handleChange = function (e) {\n      var name = e.target.name;\n      var value = e.target.type === 'checkbox' ? e.target.checked : e.target.value;\n\n      _this.setState(_defineProperty({}, name, value), _this.sortData);\n    };\n\n    _this.sortData = function () {\n      var _this$state = _this.state,\n          storeProducts = _this$state.storeProducts,\n          price = _this$state.price,\n          company = _this$state.company,\n          shipping = _this$state.shipping,\n          search = _this$state.search;\n      console.log(price);\n      var tempPrice = parseInt(price);\n      console.log(price);\n\n      var tempProducts = _toConsumableArray(storeProducts); //filtering based on price\n\n\n      tempProducts = tempProducts.filter(function (item) {\n        return item.price <= tempPrice;\n      }); // filtering based on company\n\n      if (company !== 'todos') {\n        tempProducts = tempProducts.filter(function (item) {\n          return item.company === company;\n        });\n      } // filtering based on shipping\n\n\n      if (shipping) {\n        tempProducts = tempProducts.filter(function (item) {\n          return item.freeShipping === true;\n        });\n      } // search\n\n\n      if (search.length > 0) {\n        tempProducts = tempProducts.filter(function (item) {\n          var tempSearch = search.toLowerCase();\n          var tempTitle = item.title.toLowerCase().slice(0, search.length);\n\n          if (tempSearch === tempTitle) {\n            return item;\n          }\n        });\n      } // 0 = valor inicial, search.length = o tamnho da string\n\n\n      _this.setState({\n        filteredProducts: tempProducts\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ProductProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setProducts(items);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(ProductContext.Provider, {\n        value: _objectSpread({}, this.state, {\n          handleSidebar: this.handleSidebar,\n          handleCart: this.handleCart,\n          closeCart: this.closeCart,\n          openCart: this.openCart,\n          addToCart: this.addToCart,\n          setSingleProduct: this.setSingleProduct,\n          increment: this.increment,\n          decrement: this.decrement,\n          removeItem: this.removeItem,\n          clearCart: this.clearCart,\n          handleChange: this.handleChange\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return ProductProvider;\n}(Component);\n\nvar ProductConsumer = ProductContext.Consumer;\nexport { ProductProvider, ProductConsumer };","map":{"version":3,"sources":["/Users/jorge/Downloads/react-store-3f669c84a8ff316526ad9c37a312683b5cd1283e/src/context/index.js"],"names":["React","Component","linkData","socialData","items","ProductContext","createContext","ProductProvider","state","sidebarOpen","links","socialIcons","cart","cartTax","cartTotal","storeProducts","filteredProducts","featuredProducts","singleProduct","loading","search","price","min","max","company","shipping","setProducts","products","map","item","id","sys","image","fields","file","url","product","filter","featured","maxPrice","Math","console","log","setState","getStorageCart","addTotals","localStorage","getItem","JSON","parse","getStorageProduct","getTotals","subTotal","cartItems","forEach","total","count","parseFloat","toFixed","tax","totals","cartSubTotal","syncStorage","setItem","stringify","addToCart","tempCart","tempProducts","tempItem","find","cartItem","openCart","setSingleProduct","handleSidebar","handleCart","cartOpen","closeCart","increment","decrement","removeItem","clearCart","handleChange","e","name","target","value","type","checked","sortData","tempPrice","parseInt","freeShipping","length","tempSearch","toLowerCase","tempTitle","title","slice","props","children","ProductConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { linkData } from './linkData';\nimport { socialData } from './socialData';\nimport { items } from './productData';\n\nconst ProductContext = React.createContext();\n\nclass ProductProvider extends Component {\n  state = {\n    sidebarOpen: false,\n   \n    links: linkData,\n    socialIcons: socialData,\n    cart: [],\n    \n    cartTax: 0,\n    cartTotal: 0,\n    storeProducts: [], //valores/data originais\n    filteredProducts: [],\n    featuredProducts: [],\n    singleProduct: {},\n    loading: true,\n    search: '',\n    price: 0,\n    min: 0,\n    max: 0,\n    company: 'todos',\n    shipping: false\n  };\n  componentDidMount() {\n    \n    this.setProducts(items);\n\n    \n  }\n\n\n\n  setProducts = products => {\n    let storeProducts = products.map(item => {\n      const { id } = item.sys;\n      const image = item.fields.image.fields.file.url;\n      const product = { id, ...item.fields, image };\n      return product;\n    });\n    //  featured products\n    let featuredProducts = storeProducts.filter(item => item.featured === true);\n    //get max price\n    let maxPrice = Math.max(...storeProducts.map(item => item.price));\n    console.log(maxPrice);\n\n    this.setState(\n      {\n        storeProducts,\n        filteredProducts: storeProducts,\n        featuredProducts,\n        cart: this.getStorageCart(),\n        //singleProduct: this.getStorageProduct(),\n        loading: false,\n        //price, max e maxPrice para filtrar\n        price: maxPrice,\n        max: maxPrice\n      },\n      () => {\n        this.addTotals();\n      }\n    );\n  };\n  // get cart from local storage\n  getStorageCart = () => {\n    let cart;\n    if (localStorage.getItem('cart')) {\n      cart = JSON.parse(localStorage.getItem('cart'));\n    } else {\n      cart = [];\n    }\n    return cart;\n  };\n  // get product from local storage\n  getStorageProduct = () => {\n    return localStorage.getItem('singleProduct')\n      ? JSON.parse(localStorage.getItem('singleProduct'))\n      : {};\n  };\n  // get totals\n  getTotals = () => {\n    let subTotal = 0;\n    let cartItems = 0;\n    this.state.cart.forEach(item => {\n      subTotal += item.total;\n      cartItems += item.count;\n    });\n\n    subTotal = parseFloat(subTotal.toFixed(2));\n    let tax = subTotal * 0.2;\n    tax = parseFloat(tax.toFixed(2));\n    let total = subTotal + tax;\n    total = parseFloat(total.toFixed(2));\n    return {\n      cartItems,\n      subTotal,\n      tax,\n      total\n    };\n  };\n  //add totals\n  addTotals = () => {\n    const totals = this.getTotals();\n    this.setState({\n      cartItems: totals.cartItems,\n      cartSubTotal: totals.subTotal,\n      cartTax: totals.tax,\n      cartTotal: totals.total\n    });\n  };\n  // sync storage\n  syncStorage = () => {\n    localStorage.setItem('cart', JSON.stringify(this.state.cart));\n  };\n  //add to cart\n  addToCart = id => {\n    let tempCart = [...this.state.cart];\n    let tempProducts = [...this.state.storeProducts];\n    let tempItem = tempCart.find(item => item.id === id);\n    if (!tempItem) {\n      tempItem = tempProducts.find(item => item.id === id);\n      let total = tempItem.price;\n      let cartItem = { ...tempItem, count: 1, total };\n      tempCart = [...tempCart, cartItem];\n    } else {\n      tempItem.count++;\n      tempItem.total = tempItem.price * tempItem.count;\n      tempItem.total = parseFloat(tempItem.total.toFixed(2));\n    }\n    this.setState(\n      () => {\n        return { cart: tempCart };\n      },\n      () => {\n        this.addTotals();\n        this.syncStorage();\n        this.openCart();\n      }\n    );\n  };\n  // set single product\n  setSingleProduct = id => {\n    let product = this.state.storeProducts.find(item => item.id === id);\n    localStorage.setItem('singleProduct', JSON.stringify(product));\n    this.setState({\n      singleProduct: { ...product },\n      loading: false\n    });\n  };\n\n  // handle sidebar\n  handleSidebar = () => {\n    this.setState({ sidebarOpen: !this.state.sidebarOpen });\n  };\n  // hanldle cart\n  handleCart = () => {\n    this.setState({ cartOpen: !this.state.cartOpen });\n  };\n  //close cart\n  closeCart = () => {\n    this.setState({ cartOpen: false });\n  };\n  // open\n  openCart = () => {\n    this.setState({ cartOpen: true });\n  };\n\n  //increment cart\n  increment = id => {\n    let tempCart = [...this.state.cart];\n    const cartItem = tempCart.find(item => item.id === id);\n    cartItem.count++;\n    cartItem.total = cartItem.count * cartItem.price;\n    cartItem.total = parseFloat(cartItem.total.toFixed(2));\n    this.setState(\n      () => {\n        return {\n          cart: [...tempCart]\n        };\n      },\n      () => {\n        this.addTotals();\n        this.syncStorage();\n      }\n    );\n  };\n\n  //decrement cart\n  decrement = id => {\n    let tempCart = [...this.state.cart];\n    const cartItem = tempCart.find(item => item.id === id);\n\n    cartItem.count = cartItem.count - 1;\n    if (cartItem.count === 0) {\n      this.removeItem(id);\n    } else {\n      cartItem.total = cartItem.count * cartItem.price;\n      cartItem.total = parseFloat(cartItem.total.toFixed(2));\n\n      this.setState(\n        () => {\n          return {\n            cart: [...tempCart]\n          };\n        },\n        () => {\n          this.addTotals();\n          this.syncStorage();\n        }\n      );\n    }\n  };\n\n  //clear cart\n  clearCart = () => {\n    this.setState(\n      {\n        cart: []\n      },\n      () => {\n        this.addTotals();\n        this.syncStorage();\n      }\n    );\n  };\n\n  //removeItem\n  removeItem = id => {\n    let tempCart = [...this.state.cart];\n    tempCart = tempCart.filter(item => item.id !== id);\n    this.setState(\n      {\n        cart: [...tempCart]\n      },\n      () => {\n        this.addTotals();\n        this.syncStorage();\n      }\n    );\n  };\n\n  //handle filtering\n  handleChange = e => {\n    const name = e.target.name;\n    const value =\n      e.target.type === 'checkbox' ? e.target.checked : e.target.value;\n\n    this.setState({ [name]: value }, this.sortData);\n  };\n\n  // storeProducts não deve ser modificado. Para isso,\n  // foi criada a variável tempProducts e clonado o storeProducts\n  sortData = () => {\n    const { storeProducts, price, company, shipping, search } = this.state;\n    console.log(price);\n    let tempPrice = parseInt(price);\n    console.log(price);\n    let tempProducts = [...storeProducts];\n\n    //filtering based on price\n    tempProducts = tempProducts.filter(item => item.price <= tempPrice);\n\n    // filtering based on company\n    if (company !== 'todos') {\n      tempProducts = tempProducts.filter(item => item.company === company);\n    }\n    // filtering based on shipping\n    if (shipping) {\n      tempProducts = tempProducts.filter(item => item.freeShipping === true);\n    }\n    // search\n    if (search.length > 0) {\n      tempProducts = tempProducts.filter(item => {\n        let tempSearch = search.toLowerCase();\n        let tempTitle = item.title.toLowerCase().slice(0, search.length);\n        if (tempSearch === tempTitle) {\n          return item;\n        }\n      });\n    }\n    // 0 = valor inicial, search.length = o tamnho da string\n\n    this.setState({ filteredProducts: tempProducts });\n  };\n\n  render() {\n    return (\n      <ProductContext.Provider\n        value={{\n          ...this.state,\n\n          handleSidebar: this.handleSidebar,\n          handleCart: this.handleCart,\n          closeCart: this.closeCart,\n          openCart: this.openCart,\n          addToCart: this.addToCart,\n          setSingleProduct: this.setSingleProduct,\n          increment: this.increment,\n          decrement: this.decrement,\n          removeItem: this.removeItem,\n          clearCart: this.clearCart,\n          handleChange: this.handleChange\n        }}\n      >\n        {this.props.children}\n      </ProductContext.Provider>\n    );\n  }\n}\n\nconst ProductConsumer = ProductContext.Consumer;\nexport { ProductProvider, ProductConsumer };\n"]},"metadata":{},"sourceType":"module"}